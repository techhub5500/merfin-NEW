<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Painel de investimentos com IA - Gerencie sua carteira, acompanhe dividendos e analise o mercado">
    <meta name="keywords" content="investimentos, IA, dividendos, carteira, a√ß√µes, crypto, mercado financeiro">
    <meta name="author" content="Finance Dashboard">
    <meta name="theme-color" content="#000000">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Investimentos IA - Finance Dashboard">
    <meta property="og:description" content="Gerencie seus investimentos com intelig√™ncia artificial">
    <meta property="og:type" content="website">
    
    <title>Painel de Investimentos IA - Finance Dashboard</title>
    
    <!-- Preconnect para otimiza√ß√£o -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com">
    
    <!-- Prefetch para navega√ß√£o mais r√°pida -->
    <link rel="prefetch" href="index.html" as="document">
    <link rel="prefetch" href="dash.html" as="document">
    <link rel="prefetch" href="profile.html" as="document">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/invest.css">
    
    <!-- Chart.js para gr√°ficos de investimento -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Lucide icons para sidebar -->
    <script src="https://unpkg.com/lucide@latest" defer></script>
</head>
<body class="invest-bg invest-page">

    <!-- Sidebar (fixed left) -->
    <aside class="sidebar" id="sidebar" role="complementary" aria-label="Menu de navega√ß√£o lateral">
        <div class="sidebar__inner">
            <button id="sidebar-toggle" class="sidebar__toggle" aria-label="Alternar visibilidade da barra lateral" aria-expanded="true" aria-controls="sidebar">
                <i data-lucide="chevrons-left" class="sidebar__toggle-icon" aria-hidden="true"></i>
            </button>
            <nav class="sidebar__nav" role="navigation" aria-label="Navega√ß√£o principal">
                <a href="index.html" class="sidebar__link">
                    <i data-lucide="home" class="sidebar__link-icon" aria-hidden="true"></i>
                    <span class="sidebar__link-label">Home</span>
                </a>
                <a href="dash.html" class="sidebar__link">
                    <i data-lucide="bar-chart-2" class="sidebar__link-icon" aria-hidden="true"></i>
                    <span class="sidebar__link-label">Finan√ßas</span>
                </a>
                
                <!-- Item Investimentos com subp√°ginas -->
                <div class="sidebar__group sidebar__group--invest">
                    <a href="invest.html" class="sidebar__link" aria-current="page">
                        <i data-lucide="trending-up" class="sidebar__link-icon" aria-hidden="true"></i>
                        <span class="sidebar__link-label">Investimentos</span>
                    </a>
                    <!-- Subp√°ginas de Investimentos -->
                    <div class="sidebar__subpages" id="invest-subpages">
                        <a href="invest.html" class="sidebar__sublink sidebar__sublink--active" data-subpage="dashboard">
                            <i data-lucide="layout-dashboard" class="sidebar__sublink-icon" aria-hidden="true"></i>
                            <span class="sidebar__sublink-label">Dashboard</span>
                        </a>
                        <a href="invest.html#carteira" class="sidebar__sublink" data-subpage="carteira">
                            <i data-lucide="wallet" class="sidebar__sublink-icon" aria-hidden="true"></i>
                            <span class="sidebar__sublink-label">Carteira Detalhada</span>
                        </a>
                        <a href="invest.html#fiscal" class="sidebar__sublink" data-subpage="fiscal">
                            <i data-lucide="file-text" class="sidebar__sublink-icon" aria-hidden="true"></i>
                            <span class="sidebar__sublink-label">Fiscal e Eventos</span>
                        </a>
                    </div>
                </div>
                
                <a href="profile.html" class="sidebar__link">
                    <i data-lucide="user" class="sidebar__link-icon" aria-hidden="true"></i>
                    <span class="sidebar__link-label">Perfil</span>
                </a>
            </nav>
            <button id="sidebar-logout" class="sidebar__logout" type="button" aria-label="Sair da plataforma">
                <i data-lucide="log-out" class="sidebar__logout-icon" aria-hidden="true"></i>
            </button>
        </div>
    </aside>

    <!-- App content (pushed by sidebar) -->
    <div class="app-content">

    <div class="dashboard-container">
        
        <div class="card chat-container">
            <div class="chat-header">
                <h3>Chat de Investimentos IA</h3>
                <div class="chat-header-actions">
                    <button class="chat-quick-btn chat-quick-btn--new" type="button" aria-label="Novo chat" data-tooltip="Novo chat">
                        <i data-lucide="plus-circle" aria-hidden="true"></i>
                    </button>
                    <button class="chat-quick-btn chat-quick-btn--history" type="button" aria-label="Hist√≥rico do chat" data-tooltip="Hist√≥rico">
                        <i data-lucide="clock" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
            <div class="chat-messages">
            </div>
            <div class="chat-input">
                <textarea id="chat-input" rows="1" placeholder="Pergunte qualquer coisa..." aria-label="Mensagem"></textarea>
                <button id="chat-send" class="send-btn" aria-label="Enviar mensagem">Enviar</button>
            </div>
        </div>

        <div class="card invest-card invest-card--main">
            <div class="invest-card__nav-container">
                <button class="nav-arrow nav-arrow--left" id="tab-prev" aria-label="Anterior">
                    <i data-lucide="chevron-left"></i>
                </button>
                <nav class="invest-card__tabs" id="invest-main-tabs" role="tablist">
                    <button class="invest-tab active" role="tab" aria-selected="true" data-tab="patrimonio">Patrim√¥nio</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="comparar">Comparar</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="alocacao">Aloca√ß√£o por classe</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="crypto">Crypto</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="noticias">Not√≠cias</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="carteira">Carteira</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="dividendos">Dividendos</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="transacoes">Transa√ß√µes</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="metas">Metas</button>
                    <button class="invest-tab" role="tab" aria-selected="false" data-tab="relatorios">Relat√≥rios</button>
                </nav>
                <button class="nav-arrow nav-arrow--right" id="tab-next" aria-label="Pr√≥ximo">
                    <i data-lucide="chevron-right"></i>
                </button>
            </div>

            <div class="invest-card__selectors">
                <!-- Selectors are managed dynamically by invest.js based on active tab -->
                <div id="selectors-patrimonio" class="selector-group">
                    <div class="custom-selector" id="time-selector-patrimonio">
                        <div class="selector-header">
                            <span>Tudo</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option" data-value="1M">1M</div>
                            <div class="selector-option" data-value="6M">6M</div>
                            <div class="selector-option" data-value="1Y">1Y</div>
                            <div class="selector-option active" data-value="Tudo">Tudo</div>
                        </div>
                    </div>
                    <div class="custom-selector" id="view-selector-patrimonio">
                        <div class="selector-header">
                            <span>Patrim√¥nio Bruto</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option active" data-value="bruto">Patrim√¥nio Bruto</div>
                            <div class="selector-option" data-value="liquido">Patrim√¥nio L√≠quido</div>
                        </div>
                    </div>
                </div>

                <div id="selectors-comparar" class="selector-group hidden">
                    <div class="custom-selector" id="time-selector-comparar">
                        <div class="selector-header">
                            <span>YTD</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option" data-value="MTD" title="Do in√≠cio do m√™s at√© a data de hoje">MTD</div>
                            <div class="selector-option active" data-value="YTD" title="Do in√≠cio do ano at√© a data de hoje">YTD</div>
                            <div class="selector-option" data-value="12M">12M</div>
                            <div class="selector-option" data-value="24M">24M</div>
                        </div>
                    </div>
                    <div class="custom-selector" id="index-selector-comparar">
                        <div class="selector-header">
                            <span>IBOV</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option" data-value="CDI">CDI</div>
                            <div class="selector-option" data-value="IPCA">IPCA</div>
                            <div class="selector-option active" data-value="IBOV">IBOV</div>
                        </div>
                    </div>
                </div>

                <div id="selectors-alocacao" class="selector-group hidden">
                    <div class="custom-selector" id="time-selector-alocacao">
                        <div class="selector-header">
                            <span>Presente</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option active" data-value="presente">Presente</div>
                            <div class="selector-option" data-value="mensal">Mensal</div>
                            <div class="selector-option" data-value="trimestral">Trimestral</div>
                            <div class="selector-option" data-value="semestral">Semestral</div>
                            <div class="selector-option" data-value="anual">Anual</div>
                        </div>
                    </div>
                </div>

                <div id="selectors-noticias" class="selector-group hidden">
                    <div class="custom-selector" id="news-filter-scope">
                        <div class="selector-header">
                            <span>Minha Carteira</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option active" data-value="carteira">Minha Carteira</div>
                            <div class="selector-option" data-value="mercado">Mercado Geral</div>
                        </div>
                    </div>
                    <div class="custom-selector" id="news-filter-sentiment">
                        <div class="selector-header">
                            <span>Todos Sentimentos</span>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="selector-dropdown hidden">
                            <div class="selector-option active" data-value="all">Todos Sentimentos</div>
                            <div class="selector-option" data-value="positive">Positivo üü¢</div>
                            <div class="selector-option" data-value="neutral">Neutro ‚ö™</div>
                            <div class="selector-option" data-value="negative">Negativo üî¥</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="invest-card__content" id="invest-main-content">
                <!-- Conte√∫do din√¢mico baseado na tab selecionada -->
                <div class="invest-tab-panel" data-panel="patrimonio">
                    <div class="chart-wrapper">
                        <canvas id="patrimonioChart"></canvas>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="comparar">
                    <div class="chart-wrapper">
                        <canvas id="compararChart"></canvas>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="alocacao">
                    <!-- Donut View -->
                    <div id="alocacao-main-view" class="fade-in">
                        <div class="chart-wrapper donut-container">
                            <canvas id="alocacaoDonutChart"></canvas>
                            <div id="alocacao-total-center" class="donut-center-text">
                                <span class="label">Total</span>
                                <span class="value">R$ 0,00</span>
                            </div>
                        </div>
                    </div>
                    <!-- Details View (Horizontal Bars + Metrics) -->
                    <div id="alocacao-details-view" class="hidden fade-in">
                        <div class="details-nav">
                            <button id="btn-back-alocacao" class="btn-breadcrumb">
                                <i data-lucide="chevron-left"></i>
                                <span id="breadcrumb-text">Carteira > Classe</span>
                            </button>
                        </div>
                        <div class="details-grid">
                            <div class="details-chart-col">
                                <h3>Ranking de Ativos</h3>
                                <div id="assets-ranking-container" class="ranking-list">
                                    <!-- Dynamic horizontal bars -->
                                </div>
                            </div>
                            <div class="details-metrics-col">
                                <h3>M√©tricas da Classe</h3>
                                <div class="metric-card glass">
                                    <span class="m-label">PM vs Atual</span>
                                    <span id="metric-performance" class="m-value">--</span>
                                </div>
                                <div class="metric-card glass">
                                    <span class="m-label">Proventos (12M)</span>
                                    <span id="metric-dividends" class="m-value">R$ 0,00</span>
                                </div>
                                <div class="metric-card glass">
                                    <span class="m-label">Risco</span>
                                    <span id="metric-risk" class="m-badge">M√©dio</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="metas">
                    <div class="metas-container">
                        <div class="metas-header">
                            <div class="metas-summary glass">
                                <div class="summary-item">
                                    <span class="label">Aloca√ß√£o Total</span>
                                    <span id="total-allocation-value" class="value">0%</span>
                                    <div class="mini-progress"><div id="total-allocation-bar" class="fill"></div></div>
                                </div>
                                <div class="summary-item">
                                    <span class="label">Metas Ativas</span>
                                    <span id="active-goals-count" class="value">0/10</span>
                                </div>
                                <button class="btn-add-meta" id="open-meta-modal">
                                    <i data-lucide="plus"></i>
                                    Nova Meta
                                </button>
                            </div>
                        </div>
                        
                        <div id="metas-grid" class="metas-grid">
                            <!-- Metas ser√£o carregadas dinamicamente aqui -->
                            <div class="meta-empty-state">
                                <i data-lucide="target"></i>
                                <p>Voc√™ ainda n√£o possui metas cadastradas.</p>
                                <span>Defina seus objetivos para que a IA ajude voc√™ a chegar l√°.</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="noticias">
                    <div class="news-container">
                        <div id="news-grid" class="news-grid">
                            <!-- Not√≠cias ser√£o carregadas dinamicamente aqui -->
                            <div class="news-empty-state">
                                <i data-lucide="newspaper"></i>
                                <p>Carregando as √∫ltimas not√≠cias...</p>
                                <span>Aguarde enquanto buscamos fatos relevantes para sua carteira.</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="crypto">
                    <p class="invest-placeholder">Criptomoedas e blockchain</p>
                </div>
                <div class="invest-tab-panel hidden" data-panel="carteira">
                    <p class="invest-placeholder">Composi√ß√£o e aloca√ß√£o da carteira</p>
                </div>
                <div class="invest-tab-panel hidden" data-panel="dividendos">
                    <div class="dividend-container">
                        <!-- Top Ranking de Dividendos -->
                        <div class="dividend-ranking-card">
                            <div class="card-header">
                                <h3>Maiores Pagadores (Ranking)</h3>
                                <p>Distribui√ß√£o de proventos por ativo nos √∫ltimos 12 meses</p>
                            </div>
                            <div id="dividendos-ranking-container" class="ranking-grid">
                                <!-- Cada card ter√° sua pr√≥pria tabela de detalhes oculta abaixo dele -->
                                <!-- Preenchido via JS -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="transacoes">
                    <div class="ai-query-wrapper">
                        <div class="ai-query-header">
                            <div class="ai-sparkles">
                                <i data-lucide="sparkles"></i>
                            </div>
                            <h2>Consultoria IA Personalizada</h2>
                            <p>Pe√ßa para a intelig√™ncia artificial analisar sua carteira, criar gr√°ficos sob demanda ou projetar cen√°rios futuros.</p>
                        </div>
                        
                        <div class="ai-query-form">
                            <div class="query-input-group">
                                <textarea id="ai-query-input" placeholder="Ex: 'Crie um gr√°fico comparando meus dividendos de PETR4 com o IBOV nos √∫ltimos 6 meses'"></textarea>
                                <button id="btn-ai-query-send" class="btn-ai-send">
                                    <i data-lucide="send"></i>
                                </button>
                            </div>
                            <div class="query-suggestions">
                                <span class="suggestion-chip">Analise meu risco atual</span>
                                <span class="suggestion-chip">Projete dividendos para 2026</span>
                                <span class="suggestion-chip">Comparar com CDI</span>
                            </div>
                        </div>

                        <div class="ai-query-results">
                            <!-- Resultados da IA aparecer√£o aqui -->
                        </div>
                    </div>
                </div>
                <div class="invest-tab-panel hidden" data-panel="relatorios">
                    <p class="invest-placeholder">Relat√≥rios e an√°lises de performance</p>
                </div>
            </div>

            <!-- Modal de Cadastro de Meta -->
            <div id="meta-modal" class="modal-overlay hidden">
                <div class="modal-content glass">
                    <div class="modal-header">
                        <h3>Cadastrar Nova Meta</h3>
                        <button class="btn-close-modal" id="close-meta-modal"><i data-lucide="x"></i></button>
                    </div>
                    <form id="meta-form" class="meta-form">
                        <div class="form-group">
                            <label for="meta-title">T√≠tulo da Meta</label>
                            <input type="text" id="meta-title" name="title" placeholder="Ex: Reserva de Emerg√™ncia" required>
                        </div>
                        <div class="form-group">
                            <label for="meta-desc">Descri√ß√£o / Contexto para a IA</label>
                            <textarea id="meta-desc" name="description" placeholder="Descreva por que esta meta √© importante..." rows="3"></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="meta-value">Valor Alvo (R$)</label>
                                <input type="number" id="meta-value" name="target" placeholder="0,00" required step="0.01">
                            </div>
                            <div class="form-group">
                                <label for="meta-deadline">Prazo (Data Alvo)</label>
                                <input type="date" id="meta-deadline" name="deadline" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="meta-allocation">Aloca√ß√£o do Patrim√¥nio (%)</label>
                                <input type="number" id="meta-allocation" name="allocation" placeholder="Ex: 20" required min="1" max="100">
                            </div>
                            <div class="form-group">
                                <label for="meta-priority">Prioridade</label>
                                <select id="meta-priority" name="priority">
                                    <option value="Alta">Alta</option>
                                    <option value="M√©dia" selected>M√©dia</option>
                                    <option value="Baixa">Baixa</option>
                                </select>
                            </div>
                        </div>
                        <div id="form-error" class="form-error hidden"></div>
                        <button type="submit" class="btn-save-meta">Salvar Meta</button>
                    </form>
                </div>
            </div>
        </div>

    </div>

    </div> <!-- .app-content -->

        <script>document.documentElement.dataset.page = 'Invest';</script>
        <!-- Chat History Modal (shared UI) -->
        <div id="chat-history-modal" class="chat-history-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="chat-history-title">
            <div class="chat-history-overlay" data-action="close"></div>
            <div class="chat-history-container" role="document">
                <header class="chat-history-header">
                    <h2 id="chat-history-title">Hist√≥rico do Chat</h2>
                    <button class="chat-history-close" aria-label="Fechar" data-action="close">‚úï</button>
                </header>

                <div class="chat-history-main">
                    <nav class="chat-history-tabs" role="tablist" aria-label="Escolha o chat">
                        <button role="tab" data-chat="Home" class="chat-tab">Home</button>
                        <button role="tab" data-chat="Finan√ßas" class="chat-tab">Finan√ßas</button>
                        <button role="tab" data-chat="Invest" class="chat-tab">Invest</button>
                    </nav>

                    <section class="chat-history-content">
                        <div class="chat-history-controls">
                            <input type="search" class="chat-history-search" placeholder="Pesquisar no hist√≥rico..." aria-label="Pesquisar hist√≥rico">
                            <div class="chat-history-actions">
                                <button class="btn btn-secondary btn-memories" type="button">Mem√≥rias</button>
                            </div>
                        </div>

                        <div class="chat-history-list" aria-live="polite">
                            <p class="muted">Selecione uma conversa para visualizar seu hist√≥rico.</p>
                        </div>
                    </section>

                    <section class="chat-memories" hidden>
                        <header class="memories-header">
                            <h3>Suas Mem√≥rias</h3>
                            <button class="btn btn-secondary btn-exit-memories" type="button">Sair</button>
                        </header>
                        <div class="memories-content">
                            <p class="muted">Ainda n√£o h√° mem√≥rias armazenadas.</p>
                        </div>
                    </section>
                </div>
            </div>
        </div>

        <script type="module" src="../js/main.js"></script>
        <script type="module" src="../js/invest-data.js"></script>
        <script type="module" src="../js/invest.js"></script>
</body>
</html>